---
title: Sql2000的远程连接（含Sp4补丁）  
tags: [SQLServer]
categories: 服务器
date: 2016-04-21 18:36
---

服务端配置:

#### 一 、看ping 服务器IP能否ping通。

这个实际上是看和远程sql server 2000服务器的物理连接是否存在。如果不行，请检查网络情况。

#### 二 、在Dos下输入telnet 服务器IP 端口，看能否连通。

例如：
	
	telnet 202.114.100.100 1433

1433是sql 2000对于Tcp/IP的默认侦听端口，也可通过"服务器的网络使用工具"来更改对于TCP/IP的侦听端口。通常这一步会出问题，提示："……无法打开连接,连接失败"。如果这一步有问题，应该检查以下选项：

1、在配置侦听端口时，如果把"隐藏服务器复选框"勾选上了，则意味着客户端无法通过枚举服务器来看到这台服务器，起到了保护的作用，但是Tcp/ip协议的默认端口将被隐式修改为2433，在客户端连接时必须作相应的改变。

2、如果服务器端操作系统打过xp sp2补丁，则要使windows防火墙开放1433端口，方法很简单，在防火墙的"例外"选项卡中，点击"添加端口"按钮，添加相应的端口即可。

3、检查服务器是否在1433端口侦听。如果服务器没有在tcp连接的1433端口侦听，则是连接不上的。检查方法是在服务器的dos里面输入 

	netstat –an

（全称：network status – all numeric，以数字形式显示所有连接的地址和端口），在结果列表里看是否有类似 

	tcp  127.0.0.1 1433   listening

的项。如果没有，则通常需要给sql server 2000打上至少sp3的补丁。可以在服务器端启动查询分析器，输入

	select @@version

执行后可以看到版本号，版本号在 **8.00.2039** 以下的都需要打补丁。这是Sp4的下载地址  [（SQLServer SP4补丁下载）](http://download.microsoft.com/download/9/b/f/9bff6646-2cdb-4069-ada0-548be9cb9338/SQL2000-KB884525-SP4-x86-CHS.EXE) 。注意下载后,执行的时候是解压,要在解压后的目录中执行setup.bat才是真正的安装。

这时再做telnet测试，应该OK了。

[原文参考](http://blog.163.com/tcl_6688/blog/static/168864257201151574157197)

